# SFTPush

**SFTPush** — это удобное приложение для macOS, которое автоматизирует загрузку файлов на ваш SFTP-сервер. Оно работает из строки меню и позволяет быстро загружать файлы несколькими способами:

* отслеживая папку
* используя Drag & Drop на иконку приложения в меню баре
* используя Drag & Drop на иконку приложения в Dock
	* для удобства использования лучше закрепить иконку в Dock и в настройках снять чекбобкс "Показывать иконку в доке", таким образом иконка в доке останется и перетаскивание файлов на нее будет удобным (иначе если чекбокс включен, то при длительном удержании перетаскиваемых файлов над иконкой система попытается открыть окна приложения которых у него нет)
* используя пункт в меню «Загрузить из буфера обмена»
* используя горячие клавиши

## Основные возможности

-   **Работа в строке меню:** Приложение не загромождает Dock (можно включить в настройках) и всегда доступно из строки меню.
-   **Отслеживание папки:** Автоматически загружает новые файлы, появляющиеся в указанной вами локальной папке.
-   **Drag & Drop:** Быстро загружайте файлы, перетаскивая их на иконку в строке меню или на иконку в доке.
-   **Загрузка из буфера обмена:** Загружайте изображения или файлы, скопированные в буфер обмена.
-   **Загрузка по горячей клавише:** Настройте глобальный хоткей для мгновенной загрузки содержимого буфера обмена.
-   **Надежная SFTP-загрузка:** Стабильная загрузка файлов на ваш SFTP-сервер.
-   **Копирование URL:** После успешной загрузки публичный URL файла автоматически копируется в буфер обмена.
-   **Системные уведомления:** Получайте уведомления об успешной загрузке или ошибках.
-   **Анимация загрузки:** Иконка в строке меню и в доке анимируется во время процесса загрузки.
-   **Гибкие настройки:** Управляйте поведением приложения через простое окно настроек с тремя вкладками.
-   **Ограничение размера файла:** Установите максимальный размер для загружаемых файлов, чтобы избежать случайной загрузки больших объемов данных.
-   **Рандомизация имени файла:** Опция для автоматической замены имени файла на случайную строку длиной 15 символов для обеспечения уникальности.
-   **Продвинутое управление буфером обмена:**
    *   Возможность имитировать нажатие `Cmd+C` перед загрузкой по хоткею, что удобно для приложений в которых используется эта комбинация для копирования изображения в буфер обмена.
    *   Опция для ограничения этой функции только для Monosnap (в Monosnap после добавления элементов на изображение нужно нажать Cmd+C чтобы изображение скопировалось в буфер, включение данной опции делает это автоматически перед загрузкой на сервер).

## Как использовать

### 1. Первоначальная настройка

1.  Запустите приложение. В строке меню появится иконка облака. Если папка для отслеживания не найдена или не настроена, то приложение попросит указать ее.
2.  Нажмите на иконку и выберите **"Настройки"**.
3.  **Вкладка "SFTP":**
    *   Введите данные вашего SFTP-сервера: **Host**, **Port** (обычно 22), **User** и **Password**.
    *   Укажите **Folder** на сервере, куда будут загружаться файлы (например, `/uploads/`).
    *   Введите **Base URL** — публичный адрес, который будет добавлен к имени файла для формирования конечной ссылки (например, `https://yourdomain.com/files/`).
    *   Нажмите **"Тест соединения"**, чтобы проверить корректность введенных данных.
4.  **Вкладка "Основные":**
    *   Нажмите **"Выбрать папку"** и укажите локальную папку, за которой приложение будет следить.
5.  Закройте окно настроек. Все изменения сохраняются автоматически.

### 2. Способы загрузки

-   **Автоматически (через отслеживание папки):**
    *   Просто скопируйте или сохраните любой файл в папку, которую вы выбрали для отслеживания.
    *   Приложение автоматически обнаружит файл, загрузит его и отправит уведомление.

-   **Вручную (через Drag & Drop):**
    *   Перетащите один или несколько файлов на иконку SFTPush в строке меню или в доке (если она включена).

-   **Из буфера обмена (скопированные файлы):**
    *   Скопируйте файл в Finder (нажав `Cmd+C`).
    *   Убедитесь, что в настройках на вкладке "Буфер и Хоткеи" включена опция **"Загружать скопированные файлы"**.
    *   Приложение корректно загрузит сам файл, а не его иконку.

-   **По горячей клавише (изображения или текст):**
    *   Скопируйте изображение или текст в буфер обмена.
    *   Нажмите глобальный хоткей, который вы настроили на вкладке "Буфер и Хоткеи".

## Подробное описание настроек

### Вкладка "Основные"

![](https://i.profilecdn.ru/c4aFUWgRszePLwn.jpg)

-   **Папка для отслеживания:**
    *   **Путь к папке:** Показывает выбранную папку. Нажмите "Выбрать папку", чтобы изменить ее.
-   **Поведение:**
    *   **Показывать уведомления:** Включает или отключает системные уведомления.
    *   **Включить звук уведомлений:** Добавляет звуковой сигнал к уведомлениям.
    *   **Запускать отслеживание папки при старте:** Автоматически начинает отслеживание папки после запуска приложения.
    *   **Автозапуск при старте системы:** Добавляет приложение в автозагрузку macOS.
    *   **Изменить имя файла при загрузке:** Заменяет исходное имя файла на случайную строку из 15 символов (расширение сохраняется).
    *   **Показывать иконку приложения в доке:** Управляет видимостью иконки в доке.
    *   **Ограничить максимальный размер файла:** Включает проверку размера файла перед загрузкой.
    *   **MB:** Поле для ввода лимита в мегабайтах.

### Вкладка "SFTP"

![](https://i.profilecdn.ru/3rNjyPwUykjQFlX.jpg)

-   **Host:** Адрес вашего SFTP-сервера.
-   **Port:** Порт SFTP-сервера (стандартный — 22).
-   **User:** Имя пользователя для подключения.
-   **Password:** Пароль пользователя.
-   **Folder:** Удаленная папка на сервере для загрузки файлов.
-   **Base URL:** Базовый URL для создания публичных ссылок.
-   **Тест соединения:** Кнопка для проверки доступности сервера.

### Вкладка "Буфер и Хоткеи"

![](https://i.profilecdn.ru/D7lc4kxnKlFeCT4.jpg)

-   **Формат изображения:**
    *   **Качество JPG:** Слайдер для настройки качества сжатия для изображений в формате JPG, загружаемых из буфера обмена.
    *   **Формат по-умолчанию:** Выбор между PNG и JPG как форматом по умолчанию для изображений из буфера.
-   **Хоткеи:**
    *   **Загрузить из буфера:** Поле для записи глобальной горячей клавиши для загрузки из буфера обмена.
    *   **Загружать скопированные файлы:** Разрешает загрузку файлов, предварительно скопированных в Finder через `Cmd+C`
    *   **Копировать перед загрузкой:** Имитирует нажатие `Cmd+C` перед загрузкой по хоткею. Требует предоставления прав в настройках macOS.
    *   **Только для Monosnap:** Ограничивает действие опции "Копировать перед загрузкой" только для приложения Monosnap.

## Логика работы приложения

-   **Обработка файлов:** После успешной загрузки из **отслеживаемой папки**, исходный файл перемещается во вложенную папку "Uploaded". В случае ошибки — в папку "Error". Файлы, загруженные через Drag & Drop или из буфера обмена, **не перемещаются** и остаются на своих местах.
-   **Приоритет буфера обмена:** При загрузке из буфера обмена приложение сначала ищет скопированный файл (`.fileURL`). Если файл не найден, оно ищет изображение. Это предотвращает загрузку иконки файла вместо самого файла.
-   **Права доступа (Accessibility):** Для работы функции "Копировать перед загрузкой" необходимо предоставить приложению SFTPush права в `Системные настройки > Конфиденциальность и безопасность > Универсальный доступ`.

---
